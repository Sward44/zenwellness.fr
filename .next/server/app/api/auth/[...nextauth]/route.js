(()=>{var e={};e.id=14,e.ids=[14],e.modules={846:e=>{"use strict";e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},4870:e=>{"use strict";e.exports=require("next/dist/compiled/next-server/app-route.runtime.prod.js")},9294:e=>{"use strict";e.exports=require("next/dist/server/app-render/work-async-storage.external.js")},3033:e=>{"use strict";e.exports=require("next/dist/server/app-render/work-unit-async-storage.external.js")},1828:(e,r,t)=>{"use strict";t.r(r),t.d(r,{patchFetch:()=>O,routeModule:()=>h,serverHooks:()=>U,workAsyncStorage:()=>f,workUnitAsyncStorage:()=>v});var n={};t.r(n),t.d(n,{GET:()=>w,POST:()=>w});var a=t(2706),i=t(8203),s=t(5994);let o=require("@prisma/client/runtime/library");function u(e){let r={};for(let t in e)void 0!==e[t]&&(r[t]=e[t]);return{data:r}}let c=require("@prisma/client"),l={prisma:l}.prisma||new c.PrismaClient,d=[],m=["davidlaunay567@gmail.com","contact@zenwellness.fr"];(function(){var e=Error("Cannot find module 'next-auth/providers/google'");throw e.code="MODULE_NOT_FOUND",e})(),function(){var e=Error("Cannot find module 'next-auth/providers/credentials'");throw e.code="MODULE_NOT_FOUND",e}(),function(){var e=Error("Cannot find module 'bcrypt'");throw e.code="MODULE_NOT_FOUND",e}();let p={adapter:function(e){return{createUser:({id:r,...t})=>e.user.create(u(t)),getUser:r=>e.user.findUnique({where:{id:r}}),getUserByEmail:r=>e.user.findUnique({where:{email:r}}),async getUserByAccount(r){let t=await e.account.findUnique({where:{provider_providerAccountId:r},include:{user:!0}});return t?.user??null},updateUser:({id:r,...t})=>e.user.update({where:{id:r},...u(t)}),deleteUser:r=>e.user.delete({where:{id:r}}),linkAccount:r=>e.account.create({data:r}),unlinkAccount:r=>e.account.delete({where:{provider_providerAccountId:r}}),async getSessionAndUser(r){let t=await e.session.findUnique({where:{sessionToken:r},include:{user:!0}});if(!t)return null;let{user:n,...a}=t;return{user:n,session:a}},createSession:r=>e.session.create(u(r)),updateSession:r=>e.session.update({where:{sessionToken:r.sessionToken},...u(r)}),deleteSession:r=>e.session.delete({where:{sessionToken:r}}),async createVerificationToken(r){let t=await e.verificationToken.create(u(r));return"id"in t&&t.id&&delete t.id,t},async useVerificationToken(r){try{let t=await e.verificationToken.delete({where:{identifier_token:r}});return"id"in t&&t.id&&delete t.id,t}catch(e){if(e instanceof o.PrismaClientKnownRequestError&&"P2025"===e.code)return null;throw e}},getAccount:async(r,t)=>e.account.findFirst({where:{providerAccountId:r,provider:t}}),createAuthenticator:async r=>e.authenticator.create(u(r)),getAuthenticator:async r=>e.authenticator.findUnique({where:{credentialID:r}}),listAuthenticatorsByUserId:async r=>e.authenticator.findMany({where:{userId:r}}),updateAuthenticatorCounter:async(r,t)=>e.authenticator.update({where:{credentialID:r},data:{counter:t}})}}(l),pages:{signIn:"/connexion"},session:{strategy:"jwt"},jwt:{secret:process.env.NEXTAUTH_SECRET},providers:[Object(function(){var e=Error("Cannot find module 'next-auth/providers/google'");throw e.code="MODULE_NOT_FOUND",e}())({clientId:process.env.GOOGLE_ID,clientSecret:process.env.GOOGLE_SECRET,allowDangerousEmailAccountLinking:!0}),Object(function(){var e=Error("Cannot find module 'next-auth/providers/credentials'");throw e.code="MODULE_NOT_FOUND",e}())({name:"Credidentials",credentials:{username:{label:"Username",type:"text",placeholder:"Votre email"},password:{label:"Password",type:"password"}},async authorize(e){await connectMongoose();let r=await UserModel.findOne({email:e?.username}).lean().exec();if(r){if(r?.emailVerified===null)throw Error("L'email n'est pas v\xe9rifi\xe9...");if(!r?.password)throw Error("Cr\xe9er votre mot de passe...")}else throw Error("L'email n'est pas enregistr\xe9...");if(!await Object(function(){var e=Error("Cannot find module 'bcrypt'");throw e.code="MODULE_NOT_FOUND",e}())(e.password,r.password))throw Error("Vous avez entrer un mauvais mot de passe");let{password:t,_id:n,__v:a,emailVerified:i,...s}=r;return s}})],callbacks:{async jwt({token:e,user:r,account:t,profile:n}){if(r&&t?.provider==="google"){let t;await l.Email.findMany({where:{email:n.email}})?(n.email===m?t="ADMIN":n.email===d&&(t="AMBASSADEUR"),await UserModel.findOneAndUpdate({email:n.email},{$set:{firstName:r?.firstName?r.firstName:n.given_name,lastName:r?.lastName?r.lastName:n.family_name,image:n.picture,emailVerified:null===r.emailVerified&&!0===n.email_verified?new Date:r.emailVerified}},{upsert:!0}).lean().exec()):(n.email===m?t="ADMIN":n.email===d&&(t="AMBASSADEUR"),await l.User.create({data:{id:n.sub,email:n.email,phone:"",firstName:n.given_name,lastName:n.family_name,image:n.picture,name:n.name,emailVerified:!0===n.email_verified?new Date:null,role:t||"CLIENT"}}));let{id:a,password:i,_id:s,__v:o,emailVerified:u,...c}=r;e.user=c}else r&&t?.provider==="credentials"&&(e.user=r);return e},session:async({session:e,token:r})=>(e.user=r?.user,e.accessToken=r?.accessToken,e)}};!function(){var e=Error("Cannot find module 'next-auth'");throw e.code="MODULE_NOT_FOUND",e}();let w=Object(function(){var e=Error("Cannot find module 'next-auth'");throw e.code="MODULE_NOT_FOUND",e}())(p),h=new a.AppRouteRouteModule({definition:{kind:i.RouteKind.APP_ROUTE,page:"/api/auth/[...nextauth]/route",pathname:"/api/auth/[...nextauth]",filename:"route",bundlePath:"app/api/auth/[...nextauth]/route"},resolvedPagePath:"/home/david-launay/Documents/www/zenwellness.fr/src/app/api/auth/[...nextauth]/route.js",nextConfigOutput:"",userland:n}),{workAsyncStorage:f,workUnitAsyncStorage:v,serverHooks:U}=h;function O(){return(0,s.patchFetch)({workAsyncStorage:f,workUnitAsyncStorage:v})}},6487:()=>{},8335:()=>{},2706:(e,r,t)=>{"use strict";e.exports=t(4870)}};var r=require("../../../../webpack-runtime.js");r.C(e);var t=e=>r(r.s=e),n=r.X(0,[994],()=>t(1828));module.exports=n})();